data[,35] %in% 5 ~ data[,40+2],
data[,35] %in% 6 ~ data[,41+2],
data[,35] %in% 7 ~ data[,42+2],
data[,35] %in% 8 ~ data[,43+2],
data[,35] %in% 9 ~ data[,44+2],
data[,35] %in% 10 ~ data[,45+2]
)
data[,46+2][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+2][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+2),46+2)]
# Calculate moving average for stdpjoint (var22)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+3+j] <- lag(rollapply(data_countries[[i]][,22], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+3):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvstdpjoint <- NA
data[,46+3] <- case_when(
data[,35] %in% 1 ~ data[,36+3],
data[,35] %in% 2 ~ data[,37+3],
data[,35] %in% 3 ~ data[,38+3],
data[,35] %in% 4 ~ data[,39+3],
data[,35] %in% 5 ~ data[,40+3],
data[,35] %in% 6 ~ data[,41+3],
data[,35] %in% 7 ~ data[,42+3],
data[,35] %in% 8 ~ data[,43+3],
data[,35] %in% 9 ~ data[,44+3],
data[,35] %in% 10 ~ data[,45+3]
)
data[,46+3][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+3][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+3),46+3)]
# Calculate moving average for skew (var33)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+4+j] <- lag(rollapply(data_countries[[i]][,33], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+4):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvskew <- NA
data[,46+4] <- case_when(
data[,35] %in% 1 ~ data[,36+4],
data[,35] %in% 2 ~ data[,37+4],
data[,35] %in% 3 ~ data[,38+4],
data[,35] %in% 4 ~ data[,39+4],
data[,35] %in% 5 ~ data[,40+4],
data[,35] %in% 6 ~ data[,41+4],
data[,35] %in% 7 ~ data[,42+4],
data[,35] %in% 8 ~ data[,43+4],
data[,35] %in% 9 ~ data[,44+4],
data[,35] %in% 10 ~ data[,45+4]
)
data[,46+4][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+4][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+4),46+4)]
# Calculate moving average for stddisp_gall (var23)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+5+j] <- lag(rollapply(data_countries[[i]][,23], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+5):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvstddisp_gall <- NA
data[,46+5] <- case_when(
data[,35] %in% 1 ~ data[,36+5],
data[,35] %in% 2 ~ data[,37+5],
data[,35] %in% 3 ~ data[,38+5],
data[,35] %in% 4 ~ data[,39+5],
data[,35] %in% 5 ~ data[,40+5],
data[,35] %in% 6 ~ data[,41+5],
data[,35] %in% 7 ~ data[,42+5],
data[,35] %in% 8 ~ data[,43+5],
data[,35] %in% 9 ~ data[,44+5],
data[,35] %in% 10 ~ data[,45+5]
)
data[,46+5][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+5][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+5),46+5)]
# Calculate moving average for pvoc (var29)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+6+j] <- lag(rollapply(data_countries[[i]][,29], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+6):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvpvoc <- NA
data[,46+6] <- case_when(
data[,35] %in% 1 ~ data[,36+6],
data[,35] %in% 2 ~ data[,37+6],
data[,35] %in% 3 ~ data[,38+6],
data[,35] %in% 4 ~ data[,39+6],
data[,35] %in% 5 ~ data[,40+6],
data[,35] %in% 6 ~ data[,41+6],
data[,35] %in% 7 ~ data[,42+6],
data[,35] %in% 8 ~ data[,43+6],
data[,35] %in% 9 ~ data[,44+6],
data[,35] %in% 10 ~ data[,45+6]
)
data[,46+6][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+6][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+6),46+6)]
# Calculate moving average for union (var12)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+7+j] <- lag(rollapply(data_countries[[i]][,12], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+7):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvunion <- NA
data[,46+7] <- case_when(
data[,35] %in% 1 ~ data[,36+7],
data[,35] %in% 2 ~ data[,37+7],
data[,35] %in% 3 ~ data[,38+7],
data[,35] %in% 4 ~ data[,39+7],
data[,35] %in% 5 ~ data[,40+7],
data[,35] %in% 6 ~ data[,41+7],
data[,35] %in% 7 ~ data[,42+7],
data[,35] %in% 8 ~ data[,43+7],
data[,35] %in% 9 ~ data[,44+7],
data[,35] %in% 10 ~ data[,45+7]
)
data[,46+7][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+7][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+7),46+7)]
# Calculate moving average for fpop (var30)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+8+j] <- lag(rollapply(data_countries[[i]][,30], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+8):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvfpop <- NA
data[,46+8] <- case_when(
data[,35] %in% 1 ~ data[,36+8],
data[,35] %in% 2 ~ data[,37+8],
data[,35] %in% 3 ~ data[,38+8],
data[,35] %in% 4 ~ data[,39+8],
data[,35] %in% 5 ~ data[,40+8],
data[,35] %in% 6 ~ data[,41+8],
data[,35] %in% 7 ~ data[,42+8],
data[,35] %in% 8 ~ data[,43+8],
data[,35] %in% 9 ~ data[,44+8],
data[,35] %in% 10 ~ data[,45+8]
)
data[,46+8][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+8][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+8),46+8)]
# Calculate moving average for fempar (var10)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+9+j] <- lag(rollapply(data_countries[[i]][,10], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+9):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvfempar <- NA
data[,46+9] <- case_when(
data[,35] %in% 1 ~ data[,36+9],
data[,35] %in% 2 ~ data[,37+9],
data[,35] %in% 3 ~ data[,38+9],
data[,35] %in% 4 ~ data[,39+9],
data[,35] %in% 5 ~ data[,40+9],
data[,35] %in% 6 ~ data[,41+9],
data[,35] %in% 7 ~ data[,42+9],
data[,35] %in% 8 ~ data[,43+9],
data[,35] %in% 9 ~ data[,44+9],
data[,35] %in% 10 ~ data[,45+9]
)
data[,46+9][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+9][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+9),46+9)]
# Calculate moving average for unempl (var11)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+10+j] <- lag(rollapply(data_countries[[i]][,11], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+10):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvunempl <- NA
data[,46+10] <- case_when(
data[,35] %in% 1 ~ data[,36+10],
data[,35] %in% 2 ~ data[,37+10],
data[,35] %in% 3 ~ data[,38+10],
data[,35] %in% 4 ~ data[,39+10],
data[,35] %in% 5 ~ data[,40+10],
data[,35] %in% 6 ~ data[,41+10],
data[,35] %in% 7 ~ data[,42+10],
data[,35] %in% 8 ~ data[,43+10],
data[,35] %in% 9 ~ data[,44+10],
data[,35] %in% 10 ~ data[,45+10]
)
data[,46+10][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+10][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+10),46+10)]
# Calculate moving average for turnout (var13)
data_countries <- lapply(unique(data$country), function(x)
subset(data, data$country==x)
)
for (i in 1:length(data_countries)){
for (j in 1:10) {
data_countries[[i]][,35+11+j] <- lag(rollapply(data_countries[[i]][,13], j, FUN = mean, fill = NA, align = "right"),1)
}
}
data <- do.call("rbind", data_countries)
for(x in c(37+11):ncol(data)){
# Nested loop starts from first row
for(y in 2:nrow(data)){
# Check for NA
if(is.na(data[y,x])){
data[y,x] <- data[y,x-1]
}
}
}
data$dvturnout <- NA
data[,46+11] <- case_when(
data[,35] %in% 1 ~ data[,36+11],
data[,35] %in% 2 ~ data[,37+11],
data[,35] %in% 3 ~ data[,38+11],
data[,35] %in% 4 ~ data[,39+11],
data[,35] %in% 5 ~ data[,40+11],
data[,35] %in% 6 ~ data[,41+11],
data[,35] %in% 7 ~ data[,42+11],
data[,35] %in% 8 ~ data[,43+11],
data[,35] %in% 9 ~ data[,44+11],
data[,35] %in% 10 ~ data[,45+11]
)
data[,46+11][is.na(data[,35]) & !is.na(data[,4])] <- data[,45+11][is.na(data[,35]) & !is.na(data[,4])]
data <- data[,c(0:(35+11),46+11)]
rm(data_countries)
data <- cbind(data, sapply(c(20, 26:27, 32, 34, 21, 15, 22:23, 10:13, 29:30), function(x)
(lag(data[,x], 1)+lag(data[,x], 2)+lag(data[,x], 3)+lag(data[,x], 4)+lag(data[,x], 5))/5
))
names(data)[48:62] <- c("ma_socspend", "ma_pratio9050s", "ma_pratio5010s", "ma_pratio9010s", "ma_skews", "ma_dreher", "ma_pop65", "ma_stdpjoint", "ma_stddisp_gall", "ma_fempar", "ma_unempl", "ma_union", "ma_turnout", "ma_pvoc", "ma_fpop")
library('DeclareDesign')
# X: take some parameters based on a simple model of X on Y
modX <- lm(data$redist ~ data$skew)
a_X <- summary(modX)$coefficients["(Intercept)","Estimate"]
b_X <- summary(modX)$coefficients["data$skew","Estimate"]
sd_X <- 1
rho_XY <- -.5 # Confounding
sd_X_type <- .1 # sd on effect heterogeneity
sd_Y_type <- .005 # sd on compliance heterogeneity
rho_XY_type <- 0 # Possible correlation between compliance and effects
population <- declare_population(
N = 858,
redist = sample(data$redist, N, replace = TRUE),
u_X = rnorm(N, sd = sd_X),
u_X_type = rnorm(N, df = sd_X_type)
)
fx <- function(a_X, b_X, u_X_type, u_X)
a_X + (b_X + u_X_type) + u_X
potentials <- declare_step(handler = fabricate,
redist = fx(skew, a_X, b_X, u_X_type, u_X))
estimand <- declare_estimand(
ols = mean((fx(max(skew), a_X, b_X, u_X_type, u_X) - fx(min(skew), a_X, b_X, u_X_type, u_X))/(max(skew) - min(skew))))
estimator_1 <- declare_estimator(redist ~ skew, estimand = "ols",
model = lm_robust, label = "lm")
lupu_pontusson_2011_design <- population + potentials + estimand + estimator_1
# remove variables we don't need
data_redist <- data[,c(1:4, 37:38, 36, 40, 47, 45, 41:42, 43, 46 )]
# Subsetting data
redistsample <- data[!is.na(data$redist),]
# Sorting data
redistsample <- redistsample[with(redistsample, order(id, year)),]
# create lag
redistsample$redist_lag <- unlist(by(redistsample,redistsample$id,function(x){c(NA,x[,"redist"][1:(length(x[,"redist"])-1)])}))
# set time series
redistsample$time<- unlist(by(redistsample,redistsample$id,function(x) seq(1:nrow(x))))
library('panelAR')
out1 <- panelAR(redist ~ redist_lag + dvpratio9050 + dvpratio5010 + dvturnout + dvfempar + dvstddisp_gall + dvpvoc + dvunion + dvunempl, data=redistsample, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out1)
#defining outliers
mod1.resid <- out1$residuals
index <- which(abs((mod1.resid-mean(mod1.resid))/sd(mod1.resid)) <= 1.5)
#creating a new subset without these observations
redistsample_noout<- out1$model[index,]
#running same model as spec1 with new subset
out2 <- panelAR(redist ~ redist_lag + dvpratio9050 + dvpratio5010 + dvturnout + dvfempar + dvstddisp_gall + dvpvoc + dvunion + dvunempl, data=redistsample_noout, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out2)
out3 <- panelAR(redist ~ dvpratio9050 + dvpratio5010 + as.factor(id), data=redistsample, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out3)
#defining outliers
mod3.resid <- out3$residuals
index <- which(abs((mod3.resid-mean(mod3.resid))/sd(mod3.resid)) <= 1.5)
#creating a new subset without these observations
redistsample_noout<- out3$model[index,]
#running same model as spec3 with new subset
out4 <- panelAR(redist ~ dvpratio9050 + dvpratio5010 + as.factor(id), data=redistsample_noout, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out4)
out5<- panelAR(redist ~ redist_lag + dvratio9010 + dvskew + dvturnout + dvfempar + dvstddisp_gall + dvpvoc + dvunion + dvunempl, data=redistsample, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out5)
mod5.resid <- out5$residuals
index <- which(abs((mod5.resid-mean(mod5.resid))/sd(mod5.resid)) <= 1.5)
#creating a new subset without these observations
redistsample_noout<- out5$model[index,]
#running same model as spec5 with new subset
out6<- panelAR(redist ~ redist_lag + dvratio9010 + dvskew + dvturnout + dvfempar + dvstddisp_gall + dvpvoc + dvunion + dvunempl, data=redistsample_noout, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out6)
out7 <- panelAR(redist ~ dvratio9010 + dvskew + as.factor(id), data=redistsample, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out7)
mod7.resid <- out7$residuals
index <- which(abs((mod7.resid-mean(mod7.resid))/sd(mod7.resid)) <= 1.5)
#creating a new subset without these observations
redistsample_noout<- out7$model[index,]
#running same model as spec7 with new subset
out8 <- panelAR(redist ~ dvratio9010 + dvskew + as.factor(id), data=redistsample_noout, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out8)
# remove variables we don't need
data_socspend <- data[,c(1:3, 18, 20, 48:62 )]
# Sorting data
data_socspend  <- data_socspend [with(data_socspend , order(id, year)),]
# create lag
data_socspend $socspend_lag <- unlist(by(data_socspend ,data_socspend $id,function(x){c(NA,x[,"socspend"][1:(length(x[,"socspend"])-1)])}))
# set time series
data_socspend $time<- unlist(by(data_socspend ,data_socspend $id,function(x) seq(1:nrow(x))))
out9 <- panelAR(socspend ~ socspend_lag + ma_pratio9050s + ma_pratio5010s + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher + gdpgrowth, data=_socspend , panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, bound.rho=TRUE)
out9 <- panelAR(socspend ~ socspend_lag + ma_pratio9050s + ma_pratio5010s + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher + gdpgrowth, data=_socspend , panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, bound.rho=TRUE)
out9 <- panelAR(socspend ~ socspend_lag + ma_pratio9050s + ma_pratio5010s + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher + gdpgrowth, data=_socspend , panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, bound.rho=TRUE)
out9 <- panelAR(socspend ~ socspend_lag + ma_pratio9050s + ma_pratio5010s + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher + gdpgrowth, data=data_socspend , panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, bound.rho=TRUE)
summary(out9)
#defining outliers
mod9.resid <- out9$residuals
index <- which(abs((mod9.resid-mean(mod9.resid))/sd(mod9.resid)) <= 1.5)
#creating a new subset without these observations
data_noout<- out9$model[index,]
#running same model as spec9 with new subset
out10 <- panelAR(socspend ~ socspend_lag + ma_pratio9050s + ma_pratio5010s + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher + gdpgrowth, data=data_noout, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out10)
out11 <- panelAR(socspend ~ ma_pratio9050s + ma_pratio5010s +gdpgrowth + as.factor(id), data=data_socspend , panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out11)
#defining outliers
mod11.resid <- out11$residuals
index <- which(abs((mod11.resid-mean(mod11.resid))/sd(mod11.resid)) <= 1.5)
#creating a new subset without these observations
data_noout<- out11$model[index,]
#running same model as spec11 with new subset
out12 <- panelAR(socspend ~ ma_pratio9050s + ma_pratio5010s +gdpgrowth+ as.factor(id), data=data_noout, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out12)
out13<- panelAR(socspend ~ socspend_lag + ma_pratio9010s + ma_skews + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher + gdpgrowth, data=data_socspend, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out13)
mod13.resid <- out13$residuals
index <- which(abs((mod13.resid-mean(mod13.resid))/sd(mod13.resid)) <= 1.5)
#creating a new subset without these observations
data_noout<- out13$model[index,]
#running same model as spec13 with new subset
out14<- panelAR(socspend ~ socspend_lag + ma_pratio9010s + ma_skews + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher + gdpgrowth, data=data_noout, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out14)
out15 <- panelAR(socspend ~ ma_pratio9010s + ma_skews +gdpgrowth+ as.factor(id), data=data_socspend, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out15)
mod15.resid <- out15$residuals
index <- which(abs((mod15.resid-mean(mod15.resid))/sd(mod15.resid)) <= 1.5)
#creating a new subset without these observations
data_noout<- out15$model[index,]
#running same model as spec15 with new subset
out16 <- panelAR(socspend ~ ma_pratio9010s + ma_skews +gdpgrowth + as.factor(id), data=data_noout, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out16)
out17 <- panelAR(redist ~ redist_lag + dvskew + dvratio9010 + dvturnout + dvfempar + dvstddisp_gall + dvpvoc + dvunion + dvunempl +dvfpop, data=redistsample, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out17)
#defining outliers
mod17.resid <- out17$residuals
index <- which(abs((mod17.resid-mean(mod17.resid))/sd(mod17.resid)) <= 1.5)
#creating a new subset without these observations
redistsample_noout<- out17$model[index,]
summary(data$fpop)
#running same model as spec17 with new subset
out18 <- panelAR(redist ~ redist_lag + dvskew + dvratio9010+  dvturnout + dvfempar + dvstddisp_gall + dvpvoc + dvunion + dvunempl +dvfpop, data=redistsample_noout, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
#running same model as spec17 with new subset
out18 <- panelAR(redist ~ redist_lag + dvskew + dvratio9010+  dvturnout + dvfempar + dvstddisp_gall + dvpvoc + dvunion + dvunempl +dvfpop, data=redistsample_noout, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out18)
out19<- panelAR(socspend ~ socspend_lag + ma_pratio9010s + ma_skews + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher +ma_fpop + gdpgrowth, data=data_socspend, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
print(summary(out19))
#defining outliers
mod19.resid <- out19$residuals
index <- which(abs((mod19.resid-mean(mod19.resid))/sd(mod19.resid)) <= 1.5)
#creating a new subset without these observations
data_noout<- out19$model[index,]
#running same model as spec19 with new subset
out20<- panelAR(socspend ~ socspend_lag + ma_pratio9010s + ma_skews + ma_pop65+ ma_turnout + ma_fempar + ma_stddisp_gall + ma_pvoc + ma_union + ma_unempl + ma_dreher +ma_fpop + gdpgrowth, data=data_noout, panelVar='id', timeVar='time', autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
print(summary(out20))
subset(data, year>1979)
test <- subset(data, year>1979)
View(test)
recentyears <- subset(data, year>1979)
recentyears <- recentyears[with(recentyears , order(id, year)),]
test == recentyears
identical(recentyears, test)
recentyears <- recentyears[with(recentyears , order(id, year)),]
test <- order(id, year)
test <- test[order(id, year),]
test <- test[order(test$id, test$year),]
identical(test, recentyears)
# set time series
recentyears$time<- unlist(by(recentyears ,recentyears$id,function(x) seq(1:nrow(x))))
out21<- panelAR(stdpjoint~ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
redistsample[,3] > 1979
redistsample[redistsample$year > 1979]
redistsample[,redistsample$year > 1979]
redistsample[redistsample[,3]>1979]
out21<- panelAR(stdpjoint~ma_skews + ma_stddisp_gall + ma_turnout , data=redistsample, panelVar='id', timeVar='time', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=redistsample, panelVar='id', timeVar='time',autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time',autoCorr='psar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time',autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
?panelAR
?ar1
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr='none', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr= NA, panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr= NULL, panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr= none, panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr= "none", panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE, complete.case = TRUE)
out21<- panelAR(stdpjoint~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
out21<- panelAR(stdpjoint ~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr='ar1', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
out21<- panelAR(stdpjoint ~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr='none', panelCorrMethod='pcse',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
out21<- panelAR(stdpjoint ~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr='none', panelCorrMethod='pcse')
out21<- panelAR(stdpjoint ~ ma_skews + ma_stddisp_gall + ma_turnout , data=recentyears, panelVar='id', timeVar='time', autoCorr='none', panelCorrMethod='none',rho.na.rm=TRUE, panel.weight='t-1', bound.rho=TRUE)
summary(out21)
setwd("~/Google Drive/Semester_Fall_2018/Political Economy of Development/Lupu---Pontusson")
